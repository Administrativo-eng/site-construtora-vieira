<section class="hero-simulacao fade">
  <div class="container">
    <h1>Simulador de Financiamento Imobili√°rio</h1>
    <p>Simule seu financiamento habitacional e descubra as melhores condi√ß√µes para realizar o sonho da casa pr√≥pria.</p>
  </div>
</section>

<section class="section fade">
  <div class="container">
    <div class="simulador-container">
      
      <!-- Etapas do Simulador -->
      <div class="etapas-simulador">
        <div class="etapa ativa" data-etapa="1">
          <span class="numero">1</span>
          <span class="titulo">Dados Iniciais</span>
        </div>
        <div class="etapa" data-etapa="2">
          <span class="numero">2</span>
          <span class="titulo">Seus Dados</span>
        </div>
        <div class="etapa" data-etapa="3">
          <span class="numero">3</span>
          <span class="titulo">Resultado</span>
        </div>
      </div>

      <!-- Formul√°rio de Simula√ß√£o -->
      <form id="form-simulacao" class="formulario-simulacao">
        
        <!-- Etapa 1: Dados Iniciais -->
        <div class="etapa-conteudo ativa" id="etapa-1">
          <h2>Dados Iniciais</h2>
          <p class="subtitulo">Informe os dados b√°sicos do financiamento desejado</p>
          
          <div class="campo-grupo">
            <label for="tipo-financiamento">Tipo de Financiamento</label>
            <select id="tipo-financiamento" required>
              <option value="">Selecione uma op√ß√£o</option>
              <option value="aquisicao">Aquisi√ß√£o de Im√≥vel</option>
              <option value="construcao">Constru√ß√£o</option>
              <option value="reforma">Reforma/Amplia√ß√£o</option>
            </select>
          </div>

          <div class="campo-grupo">
            <label for="valor-imovel">Valor do Im√≥vel (R$)</label>
            <input type="text" id="valor-imovel" placeholder="R$ 0,00" required>
            <small>Valor total do im√≥vel que deseja financiar</small>
          </div>

          <div class="campo-grupo">
            <label for="valor-entrada">Valor da Entrada (R$)</label>
            <input type="text" id="valor-entrada" placeholder="R$ 0,00" required>
            <small>Valor que voc√™ possui para dar de entrada</small>
          </div>

          <div class="campo-grupo">
            <label for="prazo">Prazo do Financiamento</label>
            <select id="prazo" required>
              <option value="">Selecione o prazo</option>
              <option value="120">10 anos (120 meses)</option>
              <option value="180">15 anos (180 meses)</option>
              <option value="240">20 anos (240 meses)</option>
              <option value="300">25 anos (300 meses)</option>
              <option value="360">30 anos (360 meses)</option>
              <option value="420">35 anos (420 meses)</option>
            </select>
          </div>

          <div class="campo-grupo">
            <label for="sistema">Sistema de Amortiza√ß√£o</label>
            <select id="sistema" required>
              <option value="">Selecione o sistema</option>
              <option value="sac">SAC - Sistema de Amortiza√ß√£o Constante</option>
              <option value="price">PRICE - Tabela Price</option>
            </select>
            <small>SAC: parcelas decrescentes | PRICE: parcelas fixas</small>
          </div>

          <button type="button" class="btn btn-green" onclick="proximaEtapa(2)">Pr√≥xima Etapa</button>
        </div>

        <!-- Etapa 2: Seus Dados -->
        <div class="etapa-conteudo" id="etapa-2">
          <h2>Seus Dados</h2>
          <p class="subtitulo">Informe seus dados pessoais para personalizar a simula√ß√£o</p>
          
          <div class="campo-grupo">
            <label for="renda-bruta">Renda Bruta Mensal (R$)</label>
            <input type="text" id="renda-bruta" placeholder="R$ 0,00" required>
            <small>Sua renda mensal antes dos descontos</small>
          </div>

          <div class="campo-grupo">
            <label for="idade">Idade</label>
            <input type="number" id="idade" min="18" max="80" placeholder="Ex: 35" required>
          </div>

          <div class="campo-grupo">
            <label for="juros">Taxa de Juros Anual (%)</label>
            <input type="text" id="juros" placeholder="0,00 %" required>
            <small>Taxa de juros estimada (consulte condi√ß√µes atuais)</small>
          </div>

          <div class="campo-grupo">
            <label for="cidade">Cidade do Im√≥vel</label>
            <input type="text" id="cidade" placeholder="Ex: Rondon√≥polis - MT" required>
          </div>

          <div class="botoes-navegacao">
            <button type="button" class="btn btn-outline" onclick="etapaAnterior(1)">Voltar</button>
            <button type="button" class="btn btn-green" onclick="calcularSimulacao()">Calcular</button>
          </div>
        </div>

        <!-- Etapa 3: Resultado -->
        <div class="etapa-conteudo" id="etapa-3">
          <h2>Resultado da Simula√ß√£o</h2>
          <div id="resultado-simulacao" class="resultado-container">
            <!-- Resultado ser√° inserido aqui via JavaScript -->
          </div>
          
          <div class="botoes-navegacao">
            <button type="button" class="btn btn-outline" onclick="etapaAnterior(2)">Voltar</button>
            <button type="button" class="btn btn-green" onclick="novaSimulacao()">Nova Simula√ß√£o</button>
          </div>
        </div>

      </form>
    </div>
  </div>
</section>

<!-- Se√ß√£o de Informa√ß√µes Adicionais -->
<section class="section bg-light fade">
  <div class="container">
    <h2>Informa√ß√µes Importantes</h2>
    <div class="info-cards">
      <div class="info-card">
        <h3>üìä Sistema SAC</h3>
        <p>No Sistema de Amortiza√ß√£o Constante, as parcelas come√ßam maiores e diminuem ao longo do tempo. Voc√™ paga menos juros no total.</p>
      </div>
      <div class="info-card">
        <h3>üìà Tabela PRICE</h3>
        <p>Na Tabela Price, as parcelas s√£o fixas durante todo o financiamento. Facilita o planejamento financeiro mensal.</p>
      </div>
      <div class="info-card">
        <h3>üè† FGTS</h3>
        <p>Voc√™ pode usar seu FGTS para dar entrada, amortizar o saldo devedor ou abater parcelas do financiamento.</p>
      </div>
      <div class="info-card">
        <h3>üìã Documenta√ß√£o</h3>
        <p>Tenha em m√£os: RG, CPF, comprovante de renda, certid√µes negativas e documentos do im√≥vel.</p>
      </div>
    </div>
  </div>
</section>

<style>
/* Estilos espec√≠ficos para o simulador */
.hero-simulacao {
  background: linear-gradient(135deg, #2c5aa0 0%, #1e3a5f 100%);
  color: white;
  padding: 4rem 0;
  text-align: center;
}

.hero-simulacao h1 {
  font-size: 2.5rem;
  margin-bottom: 1rem;
}

.hero-simulacao p {
  font-size: 1.2rem;
  opacity: 0.9;
}

.simulador-container {
  max-width: 800px;
  margin: 0 auto;
  background: white;
  border-radius: 15px;
  box-shadow: 0 10px 30px rgba(0,0,0,0.1);
  overflow: hidden;
}

.etapas-simulador {
  display: flex;
  background: #f8f9fa;
  border-bottom: 1px solid #e9ecef;
}

.etapa {
  flex: 1;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 1.5rem;
  cursor: pointer;
  transition: all 0.3s ease;
  border-right: 1px solid #e9ecef;
}

.etapa:last-child {
  border-right: none;
}

.etapa.ativa {
  background: #2c5aa0;
  color: white;
}

.etapa .numero {
  width: 30px;
  height: 30px;
  border-radius: 50%;
  background: #dee2e6;
  color: #495057;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  margin-right: 0.5rem;
  transition: all 0.3s ease;
}

.etapa.ativa .numero {
  background: white;
  color: #2c5aa0;
}

.etapa .titulo {
  font-weight: 500;
}

.formulario-simulacao {
  padding: 2rem;
}

.etapa-conteudo {
  display: none;
}

.etapa-conteudo.ativa {
  display: block;
}

.etapa-conteudo h2 {
  color: #2c5aa0;
  margin-bottom: 0.5rem;
}

.subtitulo {
  color: #6c757d;
  margin-bottom: 2rem;
}

.campo-grupo {
  margin-bottom: 1.5rem;
}

.campo-grupo label {
  display: block;
  font-weight: 600;
  margin-bottom: 0.5rem;
  color: #495057;
}

.campo-grupo input,
.campo-grupo select {
  width: 100%;
  padding: 0.75rem;
  border: 2px solid #e9ecef;
  border-radius: 8px;
  font-size: 1rem;
  transition: border-color 0.3s ease;
}

.campo-grupo input:focus,
.campo-grupo select:focus {
  outline: none;
  border-color: #2c5aa0;
  box-shadow: 0 0 0 3px rgba(44, 90, 160, 0.1);
}

.campo-grupo small {
  display: block;
  color: #6c757d;
  font-size: 0.875rem;
  margin-top: 0.25rem;
}

.botoes-navegacao {
  display: flex;
  gap: 1rem;
  margin-top: 2rem;
}

.btn-outline {
  background: transparent;
  border: 2px solid #2c5aa0;
  color: #2c5aa0;
}

.btn-outline:hover {
  background: #2c5aa0;
  color: white;
}

.resultado-container {
  background: #f8f9fa;
  border-radius: 10px;
  padding: 2rem;
  margin: 1rem 0;
}

.resultado-item {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 1rem 0;
  border-bottom: 1px solid #e9ecef;
}

.resultado-item:last-child {
  border-bottom: none;
}

.resultado-label {
  font-weight: 600;
  color: #495057;
}

.resultado-valor {
  font-size: 1.1rem;
  font-weight: bold;
  color: #2c5aa0;
}

.bg-light {
  background: #f8f9fa;
}

.info-cards {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
  gap: 1.5rem;
  margin-top: 2rem;
}

.info-card {
  background: white;
  padding: 1.5rem;
  border-radius: 10px;
  box-shadow: 0 5px 15px rgba(0,0,0,0.1);
  transition: transform 0.3s ease;
}

.info-card:hover {
  transform: translateY(-5px);
}

.info-card h3 {
  color: #2c5aa0;
  margin-bottom: 1rem;
}

@media (max-width: 768px) {
  .etapas-simulador {
    flex-direction: column;
  }
  
  .etapa {
    border-right: none;
    border-bottom: 1px solid #e9ecef;
  }
  
  .etapa:last-child {
    border-bottom: none;
  }
  
  .botoes-navegacao {
    flex-direction: column;
  }
  
  .hero-simulacao h1 {
    font-size: 2rem;
  }
}
</style>

<script>
// Fun√ß√µes espec√≠ficas do simulador
function proximaEtapa(etapa) {
  // Validar campos da etapa atual
  const etapaAtual = document.querySelector('.etapa-conteudo.ativa');
  const campos = etapaAtual.querySelectorAll('input[required], select[required]');
  let valido = true;
  
  campos.forEach(campo => {
    if (!campo.value.trim()) {
      campo.style.borderColor = '#dc3545';
      valido = false;
    } else {
      campo.style.borderColor = '#e9ecef';
    }
  });
  
  if (!valido) {
    alert('Por favor, preencha todos os campos obrigat√≥rios.');
    return;
  }
  
  // Avan√ßar para pr√≥xima etapa
  document.querySelectorAll('.etapa-conteudo').forEach(el => el.classList.remove('ativa'));
  document.querySelectorAll('.etapa').forEach(el => el.classList.remove('ativa'));
  
  document.getElementById(`etapa-${etapa}`).classList.add('ativa');
  document.querySelector(`[data-etapa="${etapa}"]`).classList.add('ativa');
}

function etapaAnterior(etapa) {
  document.querySelectorAll('.etapa-conteudo').forEach(el => el.classList.remove('ativa'));
  document.querySelectorAll('.etapa').forEach(el => el.classList.remove('ativa'));
  
  document.getElementById(`etapa-${etapa}`).classList.add('ativa');
  document.querySelector(`[data-etapa="${etapa}"]`).classList.add('ativa');
}

function calcularSimulacao() {
  // Validar campos da etapa 2
  const campos = document.querySelectorAll('#etapa-2 input[required], #etapa-2 select[required]');
  let valido = true;
  
  campos.forEach(campo => {
    if (!campo.value.trim()) {
      campo.style.borderColor = '#dc3545';
      valido = false;
    } else {
      campo.style.borderColor = '#e9ecef';
    }
  });
  
  if (!valido) {
    alert('Por favor, preencha todos os campos obrigat√≥rios.');
    return;
  }
  
  // Obter valores
  const valorImovel = parseFloat(document.getElementById('valor-imovel').value.replace(/[^\d]/g, '')) / 100;
  const valorEntrada = parseFloat(document.getElementById('valor-entrada').value.replace(/[^\d]/g, '')) / 100;
  const prazo = parseInt(document.getElementById('prazo').value);
  const sistema = document.getElementById('sistema').value;
  const jurosAno = parseFloat(document.getElementById('juros').value.replace(/[^\d,]/g, '').replace(',', '.'));
  const rendaBruta = parseFloat(document.getElementById('renda-bruta').value.replace(/[^\d]/g, '')) / 100;
  
  const jurosMes = jurosAno / 100 / 12;
  const valorFinanciado = valorImovel - valorEntrada;
  
  // Verificar se o valor financiado √© v√°lido
  if (valorFinanciado <= 0) {
    alert('O valor da entrada n√£o pode ser maior ou igual ao valor do im√≥vel.');
    return;
  }
  
  // Calcular parcelas
  let resultadoHTML = '';
  
  if (sistema === 'sac') {
    const amortizacao = valorFinanciado / prazo;
    let saldoDevedor = valorFinanciado;
    let totalPago = 0;
    let primeiraParcela = 0;
    let ultimaParcela = 0;
    
    for (let i = 1; i <= prazo; i++) {
      const juros = saldoDevedor * jurosMes;
      const parcela = amortizacao + juros;
      saldoDevedor -= amortizacao;
      totalPago += parcela;
      
      if (i === 1) primeiraParcela = parcela;
      if (i === prazo) ultimaParcela = parcela;
    }
    
    const comprometimentoRenda = (primeiraParcela / rendaBruta) * 100;
    
    resultadoHTML = `
      <div class="resultado-item">
        <span class="resultado-label">Sistema de Amortiza√ß√£o:</span>
        <span class="resultado-valor">SAC</span>
      </div>
      <div class="resultado-item">
        <span class="resultado-label">Valor Financiado:</span>
        <span class="resultado-valor">R$ ${valorFinanciado.toLocaleString('pt-BR', {minimumFractionDigits: 2})}</span>
      </div>
      <div class="resultado-item">
        <span class="resultado-label">Primeira Parcela:</span>
        <span class="resultado-valor">R$ ${primeiraParcela.toLocaleString('pt-BR', {minimumFractionDigits: 2})}</span>
      </div>
      <div class="resultado-item">
        <span class="resultado-label">√öltima Parcela:</span>
        <span class="resultado-valor">R$ ${ultimaParcela.toLocaleString('pt-BR', {minimumFractionDigits: 2})}</span>
      </div>
      <div class="resultado-item">
        <span class="resultado-label">Total a Pagar:</span>
        <span class="resultado-valor">R$ ${totalPago.toLocaleString('pt-BR', {minimumFractionDigits: 2})}</span>
      </div>
      <div class="resultado-item">
        <span class="resultado-label">Comprometimento da Renda:</span>
        <span class="resultado-valor">${comprometimentoRenda.toFixed(1)}%</span>
      </div>
    `;
  } else {
    const parcela = valorFinanciado * (jurosMes / (1 - Math.pow(1 + jurosMes, -prazo)));
    const totalPago = parcela * prazo;
    const comprometimentoRenda = (parcela / rendaBruta) * 100;
    
    resultadoHTML = `
      <div class="resultado-item">
        <span class="resultado-label">Sistema de Amortiza√ß√£o:</span>
        <span class="resultado-valor">PRICE</span>
      </div>
      <div class="resultado-item">
        <span class="resultado-label">Valor Financiado:</span>
        <span class="resultado-valor">R$ ${valorFinanciado.toLocaleString('pt-BR', {minimumFractionDigits: 2})}</span>
      </div>
      <div class="resultado-item">
        <span class="resultado-label">Parcela Fixa:</span>
        <span class="resultado-valor">R$ ${parcela.toLocaleString('pt-BR', {minimumFractionDigits: 2})}</span>
      </div>
      <div class="resultado-item">
        <span class="resultado-label">Total a Pagar:</span>
        <span class="resultado-valor">R$ ${totalPago.toLocaleString('pt-BR', {minimumFractionDigits: 2})}</span>
      </div>
      <div class="resultado-item">
        <span class="resultado-label">Comprometimento da Renda:</span>
        <span class="resultado-valor">${comprometimentoRenda.toFixed(1)}%</span>
      </div>
    `;
  }
  
  // Adicionar bot√£o WhatsApp
  resultadoHTML += `
    <div style="margin-top: 2rem; text-align: center;">
      <a href="https://wa.me/5566999366313?text=${encodeURIComponent('Ol√°! Fiz uma simula√ß√£o de financiamento no site e gostaria de mais informa√ß√µes sobre as condi√ß√µes.')}" 
         target="_blank" 
         class="btn btn-green">
        üí¨ Falar com Especialista
      </a>
    </div>
  `;
  
  document.getElementById('resultado-simulacao').innerHTML = resultadoHTML;
  proximaEtapa(3);
}

function novaSimulacao() {
  // Limpar formul√°rio
  document.getElementById('form-simulacao').reset();
  
  // Voltar para primeira etapa
  document.querySelectorAll('.etapa-conteudo').forEach(el => el.classList.remove('ativa'));
  document.querySelectorAll('.etapa').forEach(el => el.classList.remove('ativa'));
  
  document.getElementById('etapa-1').classList.add('ativa');
  document.querySelector('[data-etapa="1"]').classList.add('ativa');
}

// Aplicar m√°scaras nos campos de valor
document.addEventListener('DOMContentLoaded', function() {
  const camposValor = ['valor-imovel', 'valor-entrada', 'renda-bruta'];
  const campoJuros = document.getElementById('juros');
  
  camposValor.forEach(id => {
    const campo = document.getElementById(id);
    if (campo) {
      campo.addEventListener('input', function(e) {
        let valor = e.target.value.replace(/\D/g, '');
        valor = (valor / 100).toFixed(2);
        valor = valor.replace('.', ',');
        valor = valor.replace(/\B(?=(\d{3})+(?!\d))/g, '.');
        e.target.value = 'R$ ' + valor;
      });
    }
  });
  
  if (campoJuros) {
    campoJuros.addEventListener('input', function(e) {
      let valor = e.target.value.replace(/\D/g, '');
      valor = (valor / 100).toFixed(2);
      valor = valor.replace('.', ',');
      e.target.value = valor + ' %';
    });
  }
});
</script>

